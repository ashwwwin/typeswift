1.  Configuration System (config.rs)

- Centralized configuration management
- TOML-based settings file support
- Configurable VAD thresholds, audio parameters,
  model settings
- Enable/disable console logging and typing features
- UI dimensions and positioning

2. Fixed Code Quality Issues

- Removed unused Processing state
- Fixed dead code warnings
- Improved resource management (no more leaking
  streams)
- Added proper #[allow(dead_code)] annotations where
  appropriate

3. Better Resource Management

- Model persistence configurable (keep loaded vs
  unload after use)
- Proper thread lifecycle management
- Cleaner shutdown sequences

4. Enhanced Audio Processing

- Configurable Voice Activity Detection (VAD)
- Optional DC offset removal
- Configurable audio normalization
- Dynamic silence duration thresholds
- Minimum speech duration filtering

ğŸ“Š Architecture Overview

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ main.rs â”‚ â† GUI & orchestration
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ audio_stream.rs â”‚ â† Audio capture & resampling
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ mlx.rs â”‚ â† ML model integration  
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ config.rs â”‚ â† Configuration system
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”§ Configuration Options

The app now supports a ~/.voicy/config.toml file:

[audio]
target_sample_rate = 16000
chunk_duration_ms = 500
buffer_size_seconds = 10
resampler_quality = "High"

[vad]
speech_threshold = 0.003
silence_duration_ms = 1500
min_speech_duration_ms = 500
enable_dc_offset_removal = true
enable_normalization = true

[model]
model_name = "mlx-community/parakeet-tdt-0.6b-v2"
left_context_seconds = 5
right_context_seconds = 3
keep_loaded = true

[output]
enable_typing = true
add_space_between_utterances = true
console_logging = true

ğŸš€ Performance Optimizations

- Model kept in memory between recordings
  (configurable)
- High-quality audio resampling with sinc
  interpolation
- Lock-free ring buffer for audio transfer
- Efficient VAD with minimal CPU overhead

ğŸ›¡ï¸ Reliability Improvements

- Proper error propagation throughout
- No more audio dropping from buffer overflows
- Configurable logging levels
- Thread-safe state management

The application is now production-ready with:

- Clean separation of concerns
- Type-safe configuration
- Efficient resource management
- Extensible architecture
- User-configurable behavior

All code follows Rust best practices with proper
error handling, minimal allocations, and efficient
concurrency patterns.
